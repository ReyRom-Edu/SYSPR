### **–û–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏ –≤ C#**  

## **1. –í–≤–µ–¥–µ–Ω–∏–µ**  

–í –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –≤–∞–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –º–æ–∂–µ—Ç –≥—Ä–æ–∑–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ –ø–æ—Ç–æ–∫–æ–≤ –∏ –¥—Ä—É–≥–∏–º–∏ –æ—à–∏–±–∫–∞–º–∏ –≤ –ü–û. –î–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø–æ—Ç–æ–∫–æ–≤ –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö.
–í C# –¥–ª—è —ç—Ç–æ–≥–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:  

- **ConcurrentQueue<T>** ‚Äì –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ—á–µ—Ä–µ–¥—å  
- **BlockingCollection<T>** ‚Äì –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π  
- **Channel<T>** ‚Äì –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö  

–≠—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∑–∞–¥–∞—á–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.  

---

## **2. ConcurrentQueue<T>**  

### **2.1. –ß—Ç–æ —Ç–∞–∫–æ–µ ConcurrentQueue?**  
`ConcurrentQueue<T>` ‚Äì —ç—Ç–æ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ (FIFO ‚Äì **First In, First Out**), –≤—Ö–æ–¥—è—â–∞—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º—ë–Ω `System.Collections.Concurrent`.  

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**  
‚úÖ –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ—á–µ—Ä–µ–¥—å—é  
‚úÖ –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π** –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è  
‚ùå –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö  

### **2.2. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  

```csharp
using System;
using System.Collections.Concurrent;
using System.Threading;
using System.Threading.Tasks;

class Program
{
    static async Task Main()
    {
        ConcurrentQueue<int> queue = new ConcurrentQueue<int>();

        // –ü–æ—Ç–æ–∫ –∑–∞–ø–∏—Å–∏
        var producer = Task.Run(() =>
        {
            for (int i = 0; i < 5; i++)
            {
                queue.Enqueue(i);
                Console.WriteLine($"–î–æ–±–∞–≤–ª–µ–Ω–æ: {i}");
                Thread.Sleep(500);
            }
        });

        // –ü–æ—Ç–æ–∫ —á—Ç–µ–Ω–∏—è
        var consumer = Task.Run(() =>
        {
            while (true)
            {
                if (queue.TryDequeue(out int value))
                {
                    Console.WriteLine($"–ò–∑–≤–ª–µ—á–µ–Ω–æ: {value}");
                }
                else
                {
                    Console.WriteLine("–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞, –æ–∂–∏–¥–∞–µ–º...");
                }
                Thread.Sleep(300);
            }
        });

        await Task.WhenAll(producer, consumer);
    }
}
```

üîπ `Enqueue(value)` ‚Äì –¥–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –æ—á–µ—Ä–µ–¥—å  
üîπ `TryDequeue(out value)` ‚Äì –∏–∑–≤–ª–µ–∫–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å  

---

## **3. BlockingCollection<T>**  

### **3.1. –ß—Ç–æ —Ç–∞–∫–æ–µ BlockingCollection?**  
`BlockingCollection<T>` ‚Äì —ç—Ç–æ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ `ConcurrentQueue<T>`, –Ω–æ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π **–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** –∏ **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞** –æ—á–µ—Ä–µ–¥–∏.  

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**  
‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç **–æ–∂–∏–¥–∞—Ç—å** –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –æ—á–µ—Ä–µ–¥–∏  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞  
‚úÖ –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ConcurrentQueue<T>` –∏–ª–∏ `ConcurrentStack<T>`  
‚ùå –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `async/await`  

### **3.2. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  

```csharp
using System;
using System.Collections.Concurrent;
using System.Threading;
using System.Threading.Tasks;

class Program
{
    static async Task Main()
    {
        BlockingCollection<int> collection = new BlockingCollection<int>(3); // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å

        // –ü–æ—Ç–æ–∫ –∑–∞–ø–∏—Å–∏
        var producer = Task.Run(() =>
        {
            for (int i = 0; i < 5; i++)
            {
                collection.Add(i);
                Console.WriteLine($"–î–æ–±–∞–≤–ª–µ–Ω–æ: {i}");
                Thread.Sleep(500);
            }
            collection.CompleteAdding(); // –ó–∞–≤–µ—Ä—à–∞–µ–º –∑–∞–ø–∏—Å—å
        });

        // –ü–æ—Ç–æ–∫ —á—Ç–µ–Ω–∏—è
        var consumer = Task.Run(() =>
        {
            foreach (var item in collection.GetConsumingEnumerable()) 
            {
                Console.WriteLine($"–ò–∑–≤–ª–µ—á–µ–Ω–æ: {item}");
            }
        });

        await Task.WhenAll(producer, consumer);
    }
}
```

üîπ `Add(value)` ‚Äì –¥–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç, –±–ª–æ–∫–∏—Ä—É—è –ø–æ—Ç–æ–∫ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏  
üîπ `GetConsumingEnumerable()` ‚Äì —á–∏—Ç–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –∏ –æ–∂–∏–¥–∞–µ—Ç –Ω–æ–≤—ã—Ö  
üîπ `CompleteAdding()` ‚Äì –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å –¥–ª—è –∑–∞–ø–∏—Å–∏  

---

## **4. –ö–∞–Ω–∞–ª—ã (Channel<T>)**  

### **4.1. –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–∞–Ω–∞–ª—ã?**  
–ö–∞–Ω–∞–ª—ã (`System.Threading.Channels`) ‚Äì —ç—Ç–æ **—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.  

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**  
‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π** –º–µ—Ö–∞–Ω–∏–∑–º (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `BlockingCollection<T>`)  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∏ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞  
‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è  

### **4.2. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞**  

```csharp
using System;
using System.Threading.Channels;
using System.Threading.Tasks;

class Program
{
    static async Task Main()
    {
        var channel = Channel.CreateUnbounded<int>();

        var writerTask = WriteToChannel(channel.Writer);
        var readerTask = ReadFromChannel(channel.Reader);

        await Task.WhenAll(writerTask, readerTask);
    }

    static async Task WriteToChannel(ChannelWriter<int> writer)
    {
        for (int i = 0; i < 5; i++)
        {
            await writer.WriteAsync(i);
            Console.WriteLine($"–ó–∞–ø–∏—Å–∞–Ω–æ: {i}");
            await Task.Delay(500);
        }
        writer.Complete();
    }

    static async Task ReadFromChannel(ChannelReader<int> reader)
    {
        await foreach (var item in reader.ReadAllAsync())
        {
            Console.WriteLine($"–ü—Ä–æ—á–∏—Ç–∞–Ω–æ: {item}");
        }
    }
}
```

üîπ `WriteAsync(value)` ‚Äì –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç  
üîπ `ReadAllAsync()` ‚Äì —á–∏—Ç–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã **–±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**  

---

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**  
- **`ConcurrentQueue<T>`** ‚Äì –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ **–ø—Ä–æ—Å—Ç–∞—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ—á–µ—Ä–µ–¥—å** –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏  
- **`BlockingCollection<T>`** ‚Äì –µ—Å–ª–∏ –Ω—É–∂–Ω–æ **–æ–∂–∏–¥–∞–Ω–∏–µ** —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä**  
- **`Channel<T>`** ‚Äì –µ—Å–ª–∏ –Ω—É–∂–Ω–æ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ** –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏  

---

## **6. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ**  

1. **ConcurrentQueue<T>** ‚Äì –ø—Ä–æ—Å—Ç–∞—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏  
2. **BlockingCollection<T>** ‚Äì –æ—á–µ—Ä–µ–¥—å —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –±—É—Ñ–µ—Ä–æ–º  
3. **Channel<T>** ‚Äì **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π** –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö  

### **–ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã:**  
1. –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é  **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é** —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **Channel<T>**. –ù–µ—Å–∫–æ–ª—å–∫–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω—ã—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª, –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å—é —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –≤ —Ñ–∞–π–ª.
